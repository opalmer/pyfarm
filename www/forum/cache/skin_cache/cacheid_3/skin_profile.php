<?php
/*--------------------------------------------------*/
/* FILE GENERATED BY INVISION POWER BOARD           */
/* CACHE FILE: Skin set id: 3                     */
/* CACHE FILE: Generated: Wed, 12 Nov 2008 04:54:08 GMT */
/* DO NOT EDIT DIRECTLY - THE CHANGES WILL NOT BE   */
/* WRITTEN TO THE DATABASE AUTOMATICALLY            */
/*--------------------------------------------------*/

class skin_profile_3 {

 var $ipsclass;
//===========================================================================
// <ips:custom_field:desc::trigger:>
//===========================================================================
function custom_field($title="",$value="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<tr>
	<td class=\"row2\" valign=\"top\"><b>$title</b></td>
	<td class=\"row1\">$value</td>
</tr>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:dname_content_row:desc::trigger:>
//===========================================================================
function dname_content_row($previous_name="",$current_name="",$date="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<tr>
 <td class='row1'>{$previous_name}</td>
 <td class='row1'><strong>{$current_name}</strong></td>
 <td class='row2'>{$date}</td>
</tr>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:dname_wrapper:desc::trigger:>
//===========================================================================
function dname_wrapper($member_name="",$content="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<div class=\"borderwrap\">
    <div class=\"maintitle\"><{CAT_IMG}>&nbsp;{$this->ipsclass->lang['dname_window_title']} {$member_name}</div>
    <table class='ipbtable' cellspacing='1'>
    <tr>
     <th class='formsubtitle'>{$this->ipsclass->lang['dname_name_from']}</th>
     <th class='formsubtitle'>{$this->ipsclass->lang['dname_name_to']}</th>
     <th class='formsubtitle'>{$this->ipsclass->lang['dname_date']}</th>
    </tr>
    {$content}
    </table>
</div>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:friends_list_list:desc::trigger:>
//===========================================================================
function friends_list_list($friends="",$pages="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<div class='pp-tabwrap'>
	" . (($this->ipsclass->input['tab'] == 'list' OR ! $this->ipsclass->input['tab']) ? ("
		<div class='pp-tabon' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=list\", 1); return false;'>{$this->ipsclass->lang['m_friends_list']}</div>
		<div class='pp-taboff' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=pending\", 1); return false;'>{$this->ipsclass->lang['m_friends_pending']}</div>
		<div class='pp-taboff' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=mutual\", 1); return false;'>{$this->ipsclass->lang['m_friends_mutual']}</div>
	") : ("
		" . (($this->ipsclass->input['tab'] == 'pending') ? ("
			<div class='pp-taboff' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=list\", 1); return false;'>{$this->ipsclass->lang['m_friends_list']}</div>
			<div class='pp-tabon' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=pending\", 1); return false;'>{$this->ipsclass->lang['m_friends_pending']}</div>
			<div class='pp-taboff' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=mutual\", 1); return false;'>{$this->ipsclass->lang['m_friends_mutual']}</div>
		") : ("
			<div class='pp-taboff' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=list\", 1); return false;'>{$this->ipsclass->lang['m_friends_list']}</div>
			<div class='pp-taboff' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=pending\", 1); return false;'>{$this->ipsclass->lang['m_friends_pending']}</div>
			<div class='pp-tabon' style='cursor:pointer' onclick='ipsclass.location_jump(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;tab=mutual\", 1); return false;'>{$this->ipsclass->lang['m_friends_mutual']}</div>
		")) . "
	")) . "
</div>
<div class=\"pp-tabclear\">{$this->ipsclass->lang['m_friends_list']}</div>
<div class=\"borderwrap\">
	<div class='pp-header'>
		<div style='float:left;font-weight:normal;padding-top:3px'>$pages</div>
		<div align='right' style='font-weight:normal'>
			" . (($this->ipsclass->input['tab'] == 'list' OR ! $this->ipsclass->input['tab']) ? ("
				<select name='friends_filter' id='friends_filter' onchange='pp_filter_change()'>
					" . (($this->ipsclass->input['friends_filter'] == 'all' OR ! $this->ipsclass->input['friends_filter']) ? ("
						<option value='all' selected='selected'>{$this->ipsclass->lang['m_showall_friends']}</option>
					") : ("
						<option value='all'>{$this->ipsclass->lang['m_showall_friends']}</option>
					")) . "
					" . (($this->ipsclass->input['friends_filter'] == 'online') ? ("
						<option value='online' selected='selected'>{$this->ipsclass->lang['m_showonline_friends']}</option>
					") : ("
						<option value='online'>{$this->ipsclass->lang['m_showonline_friends']}</option>
					")) . "
					" . (($this->ipsclass->input['friends_filter'] == 'offline') ? ("
						<option value='offline' selected='selected'>{$this->ipsclass->lang['m_showoffline_friends']}</option>
					") : ("
						<option value='offline'>{$this->ipsclass->lang['m_showoffline_friends']}</option>
					")) . "
				</select>
			") : ("
				" . (($this->ipsclass->input['tab'] == 'mutual') ? ("
					<select name='friends_filter' id='friends_filter' onchange='pp_filter_change()'>
						" . (($this->ipsclass->input['friends_filter'] == 'mutual' OR ! $this->ipsclass->input['friends_filter']) ? ("
							<option value='mutual' selected='selected'>{$this->ipsclass->lang['fl_show_mutual']}</option>
						") : ("
							<option value='mutual'>{$this->ipsclass->lang['fl_show_mutual']}</option>
						")) . "
						" . (($this->ipsclass->input['friends_filter'] == 'added') ? ("
							<option value='added' selected='selected'>{$this->ipsclass->lang['fl_show_who_added_me']}</option>
						") : ("
							<option value='added'>{$this->ipsclass->lang['fl_show_who_added_me']}</option>
						")) . "
					</select>
				") : ("
					&nbsp;
				")) . "
			")) . "
		</div>
	</div>
	" . (($this->ipsclass->input['tab'] == 'pending') ? ("
		<form onsubmit='return pp_check_form()' action='{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;do=friends_list_moderation&amp;md5check={$this->ipsclass->md5_check}&amp;tab={$this->ipsclass->input['tab']}' method='POST'>
	") : ("")) . "
	" . ((is_array($friends) and count($friends)) ? ("
		".$this->__foreach_loop__id_491a6170e2c8f($friends,$pages)."
		<!-- BOTTOM MOD OPTIONS -->
		" . (($this->ipsclass->input['tab'] == 'pending') ? ("
			<div class='pp-header' style='text-align:right'>
				{$this->ipsclass->lang['m_dd_with_selected']}: <select name='pp_option' id='pp-moderation'>
					<option value='add_reciprocal'>{$this->ipsclass->lang['m_dd_approve_add']}</option>
					<option value='add'>{$this->ipsclass->lang['m_dd_approve']}</option>
					<option value='delete'>{$this->ipsclass->lang['m_dd_refuse']}</option>
				</select> <input class='button' type='submit' style='margin:0px' value='{$this->ipsclass->lang['m_go']}' />
			</div>
		</form>
		") : ("")) . "
		<!-- BOTTOM MOD OPTIONS -->
		
	") : ("
		<div class='post1' style='padding:6px'>
			<em>{$this->ipsclass->lang['m_nofriends']}</em>
		</div>
	")) . "
</div>
<script type='text/javascript'>
//<![CDATA[
function pp_filter_change()
{
	var selectbox = document.getElementById('friends_filter');
	var chosen    = selectbox.options[ selectbox.selectedIndex ].value;
	
	if ( chosen )
	{
		ipsclass.location_jump( ipb_var_base_url + 'act=profile&CODE=friends_list_popup&tab={$this->ipsclass->input['tab']}&friends_filter=' + chosen );
	}
}
// Check form
function pp_check_form()
{
	var selectbox = document.getElementById('pp-moderation');
	var chosen    = selectbox.options[ selectbox.selectedIndex ].value;
	
	if ( chosen == 'delete' )
	{
		if ( confirm(\"{$this->ipsclass->lang['m_confirm']}\") )
		{
			return true;
		}
		else
		{
			return false;
		}
	}
	else
	{
		return true;
	}
}
//]]>
</script>";
//--endhtml--//
return $IPBHTML;
}


//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e2c8f($friends="",$pages="")
{
	$_ips___x_retval = '';
	
	foreach( $friends as $friend )
	{
		
		$_ips___x_retval .= "
			" . (($this->ipsclass->input['tab'] == 'pending') ? ("
				<!-- Approval list -->
				<div class='pp-mini-entry-noheight-shaded' id='pp-friend-entry-{$friend['friend_id']}'>
					<div class='pp-tiny-text'>
					<div style='float:left; border-right:1px dotted black; margin-right: 3px'>
						<a href='#' title='{$this->ipsclass->lang['m_remove_friend']}' onclick='ipsclass.confirm_action(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;do=remove&amp;member_id={$friend['id']}&amp;md5check={$this->ipsclass->md5_check}&amp;tab=pending\")'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/friend_remove_small.png' alt='' border='0' /></a>
						<br />
						<a href=\"#\" title='{$this->ipsclass->lang['m_sendpm_friend']}' onclick='opener.ipsclass.location_jump(\"{$this->ipsclass->base_url}act=Msg&amp;CODE=4&amp;MID={$friend['id']}\", 1); return false;'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/send_pm_small.png' alt='' border='0' /></a>
					</div>
					<div class='pp-image-mini-wrap-floatright'><img src='{$friend['pp_mini_photo']}' width='{$friend['pp_mini_width']}' height='{$friend['pp_mini_height']}' alt='' /></div>
					<div style='float:right;padding-top:5px;padding-right:6px'><input type='checkbox' name='pp_friend_id[{$friend['id']}]' value='{$friend['id']}' /></div>
						{$friend['_pp_gender_image']} <strong><a href='#' onclick='opener.ipsclass.location_jump(\"{$this->ipsclass->base_url}showuser={$friend['id']}\", 1); return false;'>{$friend['members_display_name']}</a></strong>
						<br />
						{$friend['_pp_online_image']}
						<strong>{$this->ipsclass->lang['m_requested']}: {$friend['_friends_added']}</strong>
					</div>
				</div>
				<!-- / Approval list -->
			") : ("
				" . (($this->ipsclass->input['tab'] == 'mutual') ? ("
					<!-- Mutual list -->
					<div class='pp-mini-content-entry-noheight' id='pp-friend-entry-{$friend['friend_id']}'>
						<div class='pp-tiny-text'>
							<div class='pp-image-mini-wrap-floatright'><img src='{$friend['pp_mini_photo']}' width='{$friend['pp_mini_width']}' height='{$friend['pp_mini_height']}' alt='' /></div>
							{$friend['_pp_gender_image']} <strong><a href='#' onclick='opener.ipsclass.location_jump(\"{$this->ipsclass->base_url}showuser={$friend['id']}\", 1); return false;'>{$friend['members_display_name']}</a></strong>
							<br />
							{$friend['_pp_online_image']}
							<strong>{$this->ipsclass->lang['m_lastactive']}: {$friend['_last_active']}</strong>
						</div>
					</div>
					<!-- / Mututal list -->
				") : ("
					" . (($friend['friends_approved']) ? ("
						<!-- Normal friend list -->
						<div class='pp-mini-content-entry-noheight' id='pp-friend-entry-{$friend['friend_id']}'>
							<div class='pp-tiny-text'>
							<div style='float:left; border-right:1px dotted black; margin-right: 3px'>
								<a href='#' title='{$this->ipsclass->lang['m_remove_friend']}' onclick='ipsclass.confirm_action(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;do=remove&amp;member_id={$friend['id']}&amp;md5check={$this->ipsclass->md5_check}\")'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/friend_remove_small.png' alt='' border='0' /></a>
								<br />
								<a href=\"#\" title='{$this->ipsclass->lang['m_sendpm_friend']}' onclick='opener.ipsclass.location_jump(\"{$this->ipsclass->base_url}act=Msg&amp;CODE=4&amp;MID={$friend['id']}\", 1); return false;'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/send_pm_small.png' alt='' border='0' /></a>
							</div>
							<div class='pp-image-mini-wrap-floatright'><img src='{$friend['pp_mini_photo']}' width='{$friend['pp_mini_width']}' height='{$friend['pp_mini_height']}' alt='' /></div>
								{$friend['_pp_gender_image']} <strong><a href='#' onclick='opener.ipsclass.location_jump(\"{$this->ipsclass->base_url}showuser={$friend['id']}\", 1); return false;'>{$friend['members_display_name']}</a></strong>
								<br />
								{$friend['_pp_online_image']}
								<strong>{$this->ipsclass->lang['m_lastactive']}: {$friend['_last_active']}</strong>
							</div>
							<!-- / Normal friend list -->
						</div>
					") : ("
						<!-- UNAPPROVED friend list -->
						<div class='pp-mini-entry-noheight-shaded' id='pp-friend-entry-{$friend['friend_id']}'>
							<div class='pp-tiny-text'>
							<div style='float:left; border-right:1px dotted black; margin-right: 3px'>
								<a href='#' title='{$this->ipsclass->lang['m_remove_friend']}' onclick='ipsclass.confirm_action(\"{$this->ipsclass->base_url}act=profile&amp;CODE=friends_list_popup&amp;do=remove&amp;member_id={$friend['id']}&amp;md5check={$this->ipsclass->md5_check}\")'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/friend_remove_small.png' alt='' border='0' /></a>
								<br />
								<a href=\"#\" title='{$this->ipsclass->lang['m_sendpm_friend']}' onclick='opener.ipsclass.location_jump(\"{$this->ipsclass->base_url}act=Msg&amp;CODE=4&amp;MID={$friend['id']}\", 1); return false;'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/send_pm_small.png' alt='' border='0' /></a>
							</div>
							<div class='pp-image-mini-wrap-floatright'><img src='{$friend['pp_mini_photo']}' width='{$friend['pp_mini_width']}' height='{$friend['pp_mini_height']}' alt='' /></div>
								{$friend['_pp_gender_image']} <strong><a href='#' onclick='opener.ipsclass.location_jump(\"{$this->ipsclass->base_url}showuser={$friend['id']}\", 1); return false;'>{$friend['members_display_name']}</a></strong>
								[ {$this->ipsclass->lang['m_pending']} ]
								<br />
								{$friend['_pp_online_image']}
								<strong>{$this->ipsclass->lang['m_lastactive']}: {$friend['_last_active']}</strong>
							</div>
							<!-- / UNAPPROVED friend list -->
						</div>
					")) . "
				")) . "
			")) . "
		";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// <ips:get_photo:desc::trigger:>
//===========================================================================
function get_photo($show_photo="",$show_width="",$show_height="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<img src=\"$show_photo\" alt=\"{$this->ipsclass->lang['get_photo']}\" $show_width $show_height />";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:member_rank_img:desc::trigger:>
//===========================================================================
function member_rank_img($filename="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<img src=\"$filename\" alt=\"{$this->ipsclass->lang['group_icon']}\" />";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:no_custom_information:desc::trigger:>
//===========================================================================
function no_custom_information() {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<tr>
	<td colspan=\"2\" align=\"center\" class=\"row2\">{$this->ipsclass->lang['no_info']}</td>
</tr>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:personal_portal_iframe_comments:desc::trigger:>
//===========================================================================
function personal_portal_iframe_comments($member="",$comments="",$pages="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<div id='pp-iframe-wrap' class='pp-contentbox-back' style='overflow:auto'>
<form onsubmit='check_form()' action='{$this->ipsclass->base_url}act=profile&amp;CODE=personal_iframe_comments_save&amp;member_id={$member['id']}&amp;md5check={$this->ipsclass->md5_check}' method='POST'>
	" . ((is_array($comments) and count($comments)) ? ("
		".$this->__foreach_loop__id_491a6170e345f($member,$comments,$pages)."
		<div class='pp-contentbox-entry-noheight'>
			<div style='float:right'>
				" . ((( $member['id'] == $this->ipsclass->member['id'] ) OR ( $this->ipsclass->member['g_is_supmod'] )) ? ("
					<select name='pp-moderation' id='pp-moderation'>
						<option value='approve'>{$this->ipsclass->lang['m_comment_app']}</option>
						<option value='unapprove'>{$this->ipsclass->lang['m_comment_unapp']}</option>
						<option value='delete'>{$this->ipsclass->lang['m_comment_delete']}</option>
					</select>
					<input type='submit' class='button' value='{$this->ipsclass->lang['m_go_button']}' />
				") : ("")) . "
			</div>
			<div style='margin-top:7px'>{$pages}&nbsp;</div>
	") : ("
		<div class='post1' style='padding:6px'>
			<em>{$this->ipsclass->lang['m_no_comments']} {$member['members_display_name']}.</em>
		</div>
	")) . "
</form>
</div>
<br /><br /><br /> <!-- Gotta give room for page jump... -->
<script type='text/javascript'>
//<![CDATA
var _saved = parseInt( \"{$this->ipsclass->input['_saved']}\" );
if ( _saved )
{
	parent.ips_personal_portal.reload_comments();
}
// Check form
function check_form()
{
	var selectbox = document.getElementById('pp-moderation');
	var chosen    = selectbox.options[ selectbox.selectedIndex ].value;
	
	if ( chosen == 'delete' )
	{
		if ( confirm(\"{$this->ipsclass->lang['m_confirm']}\") )
		{
			return true;
		}
		else
		{
			return false;
		}
	}
	else
	{
		return true;
	}
}
//]]>
</script>";
//--endhtml--//
return $IPBHTML;
}


//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e345f($member="",$comments="",$pages="")
{
	$_ips___x_retval = '';
	
	foreach( $comments as $comment )
	{
		
		$_ips___x_retval .= "
			" . (($comment['comment_approved']) ? ("
				<div class='pp-contentbox-entry-noheight' id='pp-comment-entry-main-{$comment['comment_id']}'>
			") : ("
				<div class='pp-contentbox-entry-noheight-mod' id='pp-comment-entry-main-{$comment['comment_id']}'>
			")) . "
				<div class='pp-tiny-text'>
				<div class='pp-image-thumb-wrap-floatright'><img src='{$comment['pp_thumb_photo']}' width='{$comment['pp_thumb_width']}' height='{$comment['pp_thumb_height']}' alt='' /></div>
					" . ((( $member['id'] == $this->ipsclass->member['id'] ) OR ( $this->ipsclass->member['g_is_supmod'] )) ? ("
						<!-- MOD CHECKBOX -->
						<input type='checkbox' class='input-checkbox' id=\"pp-checked-{$comment['comment_id']}\" name=\"pp-checked[{$comment['comment_id']}]\" value='1' onclick=\"parent.ips_personal_portal.toggle_comment_box('{$comment['comment_id']}', 1)\" />
						<!-- / MOD CHECKBOX -->
					") : ("")) . "
					{$comment['_pp_gender_image']} <strong><a href='{$this->ipsclass->base_url}showuser={$comment['id']}' target='_parent'>{$comment['members_display_name']}</a></strong>
					<br />
					{$comment['comment_content']}
					<br />
					<strong>{$comment['_comment_date']}</strong>
				</div>
			</div>
		";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// <ips:personal_portal_iframe_friends:desc::trigger:>
//===========================================================================
function personal_portal_iframe_friends($member="",$friends="",$pages="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<div id='pp-iframe-wrap' class='pp-contentbox-back' style='overflow:auto'>
	" . ((is_array($friends) and count($friends)) ? ("
		".$this->__foreach_loop__id_491a6170e3845($member,$friends,$pages)."
		" . (($pages OR ( $member['id'] == $this->ipsclass->member['id'] )) ? ("
			<div class='pp-contentbox-entry-noheight'>
				<div style='float:right'>
					" . (($member['id'] == $this->ipsclass->member['id']) ? ("
						<a href='#' onclick='parent.friends_pop()'>{$this->ipsclass->lang['m_manage_friends']}</a>
					") : ("")) . "
				</div>
				<div>{$pages}&nbsp;</div>
			</div>
		") : ("")) . "
	") : ("
		<div class='post1' style='padding:6px'>
			<em>{$this->ipsclass->lang['m_nofriends']}</em>
		</div>
	")) . "
</div>
<br /><br /><br /> <!-- Gotta give room for page jump... -->";
//--endhtml--//
return $IPBHTML;
}


//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e3845($member="",$friends="",$pages="")
{
	$_ips___x_retval = '';
	
	foreach( $friends as $friend )
	{
		
		$_ips___x_retval .= "
			<div class='pp-contentbox-entry-noheight' id='pp-comment-entry-main-{$friend['comment_id']}'>
				<div class='pp-tiny-text'>
				<div class='pp-image-thumb-wrap-floatright'><img src='{$friend['pp_thumb_photo']}' width='{$friend['pp_thumb_width']}' height='{$friend['pp_thumb_height']}' alt='' /></div>
					{$friend['_pp_gender_image']} <strong><a href='{$this->ipsclass->base_url}showuser={$friend['id']}' target='_parent'>{$friend['members_display_name']}</a></strong>
					<div class='pp-tiny-text'>
						{$friend['g_title']}
						<br />{$friend['posts']} {$this->ipsclass->lang['fav_posts']}
						<br />{$this->ipsclass->lang['m_active']}: {$friend['_last_active']}
					</div>
				</div>
			</div>
		";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// <ips:personal_portal_iframe_settings:desc::trigger:>
//===========================================================================
function personal_portal_iframe_settings($member=array(),$friends=0,$error="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<div id='pp-iframe-wrap' class='pp-contentbox-back'>
	<div class='pp-contentbox-entry-noheight'>
		" . (($error) ? ("
			<div class='input-warn-content'>$error</div>
		") : ("")) . "
		" . (($friends) ? ("
			<fieldset>
				<legend><strong>{$this->ipsclass->lang['m_friends_pending']}</strong></legend>
				<table cellpadding='0' cellspacing='1' width='100%'>
				<tr>
					<td class=\"row1\" style='padding:6px;'>
						{$this->ipsclass->lang['m_friend_str_1']} <strong>$friends</strong> {$this->ipsclass->lang['m_friend_str_2']}
						<br /><a href='#' onclick='parent.friends_pop( \"&amp;tab=pending\"); return false'>{$this->ipsclass->lang['m_manage_friends_list']}</a>
					</td>
				</tr>
				</table>
			</fieldset>
			<br />
		") : ("")) . "
		<form action='{$this->ipsclass->base_url}act=profile&amp;CODE=personal_iframe_settings_save&amp;member_id={$member['id']}&amp;md5check={$this->ipsclass->md5_check}'  enctype='multipart/form-data' method='POST'>
" . (($this->ipsclass->member['g_edit_profile']==1) ? ("
	" . (($member['id'] == $this->ipsclass->member['id']) ? ("
	<!-- Can update photo? -->
		<input type='hidden' name='MAX_FILE_SIZE' value='{$member['_max_file_size']}' />
		
		<fieldset>
			<legend><strong>{$this->ipsclass->lang['get_photo']}</strong></legend>
			<table cellpadding='0' cellspacing='1' width='100%'>
			<tr>
				<td width=\"30%\" class=\"row1\" style='padding:6px;' valign='top'>
					<strong>{$this->ipsclass->lang['m_your_pic']}</strong>
				</td>
				<td width=\"70%\" class=\"row2\" style='padding:6px;'>
					<input type='file' name='upload_photo' />
					<div class='pp-tiny-text'>
						{$this->ipsclass->lang['pp_photo_desc']}
					</div>
				</td>
			</tr>
			<tr>
				<td width=\"30%\" class=\"row1\" style='padding:6px;' valign='top'>
					<strong>{$this->ipsclass->lang['m_delete_pic']}</strong>
				</td>
				<td width=\"70%\" class=\"row2\" style='padding:6px;'>
					<input type='checkbox' class='checkbox' name='delete_photo' value='1' />
				</td>
			</tr>
			</table>
		</fieldset>
		
		<br />
	") : ("")) . "
		<fieldset>
			<legend><strong>{$this->ipsclass->lang['m_personal_statement']}</strong> <span class='pp-tiny-text'>{$this->ipsclass->lang['m_char_limit']}</span></legend>
			<table cellpadding='0' cellspacing='1' width='100%'>
			<tr>
				<td class=\"row1\" style='padding:6px;text-align:center'>
					<textarea name='pp_bio_content' rows='5' cols='60' style='width:95%;height:100px'>{$member['_pp_bio_content']}</textarea>
					<div class='pp-tiny-text' style='text-align:left'>{$this->ipsclass->lang['m_statement_bbcode']}</div>
				</td>
			</tr>
			</table>
		</fieldset>
		
		<br />
		
		<fieldset>
			<legend><strong>{$this->ipsclass->lang['m_website_title']}</strong> <span class='pp-tiny-text'>{$this->ipsclass->lang['m_website_explain']}</span></legend>
			<table cellpadding='0' cellspacing='1' width='100%'>
			<tr>
				<td class=\"row1\" style='padding:6px;text-align:left'>
					<input type='text' name='website' size='25' style='width:95%' value='{$member['website']}' />
				</td>
			</tr>
			</table>
		</fieldset>
		
		<br />
") : ("")) . "
		<fieldset>
			<legend><strong>{$this->ipsclass->lang['m_notifications']}</strong></legend>
			<table cellpadding='0' cellspacing='1' width='100%'>
			<tr>
				<td width=\"40%\" class=\"row1\" style='padding:6px;'>
					<strong>{$this->ipsclass->lang['m_new_comments']}</strong>
					<div class='pp-tiny-text'>{$this->ipsclass->lang['m_choose_comm_type']}</div>
				</td>
				<td width=\"60%\" class=\"row2\" style='padding:6px;'>
					<select name='pp_setting_notify_comments'>{$member['_pp_setting_notify_comments']}</select>
				</td>
			</tr>
			<tr>
				<td width=\"40%\" class=\"row1\" style='padding:6px;'>
					<strong>{$this->ipsclass->lang['m_new_friends']}</strong>
					<div class='pp-tiny-text'>{$this->ipsclass->lang['m_choose_friend_type']}</div>
				</td>
				<td width=\"60%\" class=\"row2\" style='padding:6px;'>
					<select name='pp_setting_notify_friend'>{$member['_pp_setting_notify_friend']}</select>
				</td>
			</tr>
			</table>
		</fieldset>
		
		<br />
		
		<fieldset>
			<legend><strong>{$this->ipsclass->lang['m_mod_type']}</strong></legend>
			<table cellpadding='0' cellspacing='1' width='100%'>
			<tr>
				<td width=\"40%\" class=\"row1\" style='padding:6px;'>
					<strong>{$this->ipsclass->lang['m_new_comments']}</strong>
					<div class='pp-tiny-text'>{$this->ipsclass->lang['m_choose_cmod_type']}</div>
				</td>
				<td width=\"60%\" class=\"row2\" style='padding:6px;'>
					<select name='pp_setting_moderate_comments'>{$member['_pp_setting_moderate_comments']}</select>
				</td>
			</tr>
			<tr>
				<td width=\"40%\" class=\"row1\" style='padding:6px;'>
					<strong>{$this->ipsclass->lang['m_new_friends']}</strong>
					<div class='pp-tiny-text'>{$this->ipsclass->lang['m_choose_fmod_type']}</div>
				</td>
				<td width=\"60%\" class=\"row2\" style='padding:6px;'>
					<select name='pp_setting_moderate_friends'>{$member['_pp_setting_moderate_friends']}</select>
				</td>
			</tr>
			</table>
		</fieldset>
		
		<br />
		
		<fieldset>
			<legend><strong>{$this->ipsclass->lang['m_settings_header']}</strong></legend>
			<table cellpadding='0' cellspacing='1' width='100%'>
			<tr>
				<td width=\"40%\" class=\"row1\" style='padding:6px;'>
					<strong>{$this->ipsclass->lang['m_show_x_visitors']}</strong>
					<div class='pp-tiny-text'>{$this->ipsclass->lang['op_change_refresh']}</div>
				</td>
				<td width=\"60%\" class=\"row2\" style='padding:6px;'>
					<select name='pp_setting_count_visitors'>
					" . (($member['pp_setting_count_visitors'] == 0) ? ("
						<option value='0' selected='selected'>0</option>
					") : ("
						<option value='0'>0</option>
					")) . "
					" . (($member['pp_setting_count_visitors'] == 3) ? ("
						<option value='3' selected='selected'>3</option>
					") : ("
						<option value='3'>3</option>
					")) . "
					" . (($member['pp_setting_count_visitors'] == 5) ? ("
						<option value='5' selected='selected'>5</option>
					") : ("
						<option value='5'>5</option>
					")) . "
					" . (($member['pp_setting_count_visitors'] == 10) ? ("
						<option value='10' selected='selected'>10</option>
					") : ("
						<option value='10'>10</option>
					")) . "
					</select>
				</td>
			</tr>
			<tr>
				<td width=\"40%\" class=\"row1\" style='padding:6px;'>
					<strong>{$this->ipsclass->lang['m_show_x_comments']}</strong>
					<div class='pp-tiny-text'>{$this->ipsclass->lang['op_change_refresh']}</div>
				</td>
				<td width=\"60%\" class=\"row2\" style='padding:6px;'>
					<select name='pp_setting_count_comments'>
					" . (($member['pp_setting_count_comments'] == 0) ? ("
						<option value='0' selected='selected'>0</option>
					") : ("
						<option value='0'>0</option>
					")) . "
					" . (($member['pp_setting_count_comments'] == 3) ? ("
						<option value='3' selected='selected'>3</option>
					") : ("
						<option value='3'>3</option>
					")) . "
					" . (($member['pp_setting_count_comments'] == 5) ? ("
						<option value='5' selected='selected'>5</option>
					") : ("
						<option value='5'>5</option>
					")) . "
					" . (($member['pp_setting_count_comments'] == 10) ? ("
						<option value='10' selected='selected'>10</option>
					") : ("
						<option value='10'>10</option>
					")) . "
					</select>
				</td>
			</tr>
			<tr>
				<td width=\"40%\" class=\"row1\" style='padding:6px;'>
					<strong>{$this->ipsclass->lang['m_show_x_friends']}</strong>
					<div class='pp-tiny-text'>{$this->ipsclass->lang['op_change_refresh']}</div>
				</td>
				<td width=\"60%\" class=\"row2\" style='padding:6px;'>
					<select name='pp_setting_count_friends'>
					" . (($member['pp_setting_count_friends'] == 0) ? ("
						<option value='0' selected='selected'>0</option>
					") : ("
						<option value='0'>0</option>
					")) . "
					" . (($member['pp_setting_count_friends'] == 3) ? ("
						<option value='3' selected='selected'>3</option>
					") : ("
						<option value='3'>3</option>
					")) . "
					" . (($member['pp_setting_count_friends'] == 5) ? ("
						<option value='5' selected='selected'>5</option>
					") : ("
						<option value='5'>5</option>
					")) . "
					" . (($member['pp_setting_count_friends'] == 10) ? ("
						<option value='10' selected='selected'>10</option>
					") : ("
						<option value='10'>10</option>
					")) . "	
					</select>
				</td>
			</tr>
			</table>
		</fieldset>
		
		<br />
		
		<div class='row1' style='padding:6px; margin-bottom:1px;text-align:center'>
			<input type='submit' class='button' value='{$this->ipsclass->lang['m_save_settings']}' />
		</div>
		</form>
	</div>
</div>
" . (($this->ipsclass->input['_saved']) ? ("
	<script type='text/javascript'>
	//<![CDATA[
		parent.ips_personal_portal.update_personal_photo( \"{$this->ipsclass->vars['upload_url']}/{$member['pp_main_photo']}\", parseInt({$member['pp_main_width']}), parseInt({$member['pp_main_height']}) );
		parent.ips_personal_portal.update_personal_statement( \"{$member['__pp_bio_content']}\", \"{$member['website']}\" );
	//]]>
	</script>
") : ("")) . "";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:personal_portal_main:desc::trigger:>
//===========================================================================
function personal_portal_main($tabs=array(),$member=array(),$comments="",$friends=array(),$visitors=array(),$default_tab='posts') {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<script type=\"text/javascript\" src=\"{$this->ipsclass->vars['board_url']}/jscripts/ipb_profile.js\"></script>
<script type='text/javascript' src=\"{$this->ipsclass->vars['board_url']}/jscripts/ips_profile_portal.js\"></script>
<script type=\"text/javascript\" src=\"{$this->ipsclass->vars['board_url']}/jscripts/ipb_topic.js\"></script>
<!--We (?:c|sh)ould use CSS for this.-->
<table cellspacing='4' cellpadding='0' width='100%'  border='0' class='ipbtable'>
<tr>
	<td style='width:210px' valign='top'>
	<!-- LEFT TABLE -->
		<div class=\"borderwrap\">
			<div class=\"maintitle\">{$this->ipsclass->lang['m_profile_title']}</div>
			<div class='subtitle'>{$this->ipsclass->lang['get_photo']}</div>
			<table cellpadding='0' cellspacing='0' width='100%'>
			<tr>
				<td width='60%' class='row1' style='padding:3px;margin-bottom:0px' valign='middle' align='center'>
				<!-- Personal Photo -->
					<img id='pp-main-photo' src='{$member['pp_main_photo']}' width='{$member['pp_main_width']}' height='{$member['pp_main_height']}' alt='' />
				<!-- / Personal Photo -->
				<!-- Quick contact -->
				" . (($this->ipsclass->member['id'] AND ( $member['id'] != $this->ipsclass->member['id'])) ? ("
					<div style='margin-top:10px;margin-bottom:6px'>
						<div id='pp-friend-wrap'>
							<!-- Add / remove friend added via JS -->
						</div>
						<img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/send_pm_small.png' alt='' border='0' /> <a href=\"{$this->ipsclass->base_url}act=Msg&amp;CODE=4&amp;MID={$member['id']}\">{$this->ipsclass->lang['pm']}</a>
					</div>
				") : ("")) . "
				<!-- / Quick contact -->
				</td>
			</tr>
			</table>
			
			" . (($this->ipsclass->vars['pp_allow_member_rate']) ? ("
				<!-- Rating -->
				<div class='subtitle'>{$this->ipsclass->lang['rating']}</div>
				<div class='row1' style='padding:6px; padding-left:10px; text-align: center' id='pp-rating-wrapper'>
					&nbsp;
				</div>
				<!-- / Rating -->
			") : ("")) . "
			
			<!-- Options -->
			<div class='subtitle'>{$this->ipsclass->lang['options']}</div>
			<div class='row1' style='padding:6px; padding-left:10px; text-align: center'>
				<div class='popmenubutton-new' id='profile-options'>{$this->ipsclass->lang['options']}</div>
			</div>
			<!-- / Options -->
			
			<!-- Personal Statement -->
			<div class='subtitle'>{$this->ipsclass->lang['m_personal_statement']}</div>
			<div class='row1' style='padding:6px; padding-left:10px' id='pp-personal_statement'>
				" . (($member['pp_bio_content']) ? ("
					{$member['pp_bio_content']}
					") : ("
					<em>{$member['members_display_name']} {$this->ipsclass->lang['m_no_statement']}.</em>
				")) . "
				" . (($member['_website']) ? ("
					<div style='padding-top:5px'>
						" . ((strlen($member['_website']) > 30) ? ("
							<a href='{$member['_website']}' target='_blank'>{$this->ipsclass->lang['m_visit_website']}</a>
						") : ("
							<a href='{$member['_website']}' target='_blank'>{$member['_website']}</a>
						")) . "
					</div>
				") : ("")) . "
			</div>
			<!-- / Personal Statement -->
			
			<!-- Personal Info -->
			<div class='subtitle'>{$this->ipsclass->lang['m_personal_info']}</div>
			<div class='row1' style='padding:6px; padding-left:10px'>{$member['members_display_name']}</div>
			" . (($member['_title']!='') ? ("
				<div class='row1' style='padding:6px; padding-left:10px'>{$member['_title']}</div>
			") : ("")) . "
			<div class='row1' style='padding:6px; padding-left:10px' id='pp-entry-age-wrap'>
				" . (($member['_age'] > 0) ? ("
					 <span id='pp-entry-age-text'>{$member['_age']}</span> <span id='pp-entry-age-yearsold'>{$this->ipsclass->lang['m_years_old']}</span>
				") : ("
					<span id='pp-entry-age-text'>{$this->ipsclass->lang['m_age_unknown']}</span> <span id='pp-entry-age-yearsold' style='display:none'>{$this->ipsclass->lang['m_years_old']}</span>
				")) . "
			</div>
			<div class='row1' style='padding:6px; padding-left:10px'>
				<div id='pp-entry-gender-wrap'>
					" . (($member['pp_gender']) ? ("
						<span id='pp-entry-gender-imgwrap'>{$member['_pp_gender_image']}</span> <span id='pp-entry-gender-text'>{$member['_pp_gender_text']}</span>
					") : ("
						<span id='pp-entry-gender-imgwrap'>{$member['_pp_gender_image']}</span> <span id='pp-entry-gender-text'>{$this->ipsclass->lang['m_no_gender']}</span>
					")) . "
				</div>
				" . (($member['id'] == $this->ipsclass->member['id'] AND $this->ipsclass->member['g_edit_profile']==1) ? ("
					<div class='popupmenu-new' id='pp-entry-gender-wrap_menu' style='display:none;width:162px'>
						<div class='popupmenu-item'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/gender_male.png' alt='' border='0' /> <a href='#' onclick=\"ips_personal_portal.save_settings( 'gender', { 'pp_gender' : 'male' }, ''); return false;\">{$this->ipsclass->lang['m_gender_as_male']}</a></div>
						<div class='popupmenu-item'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/gender_female.png' alt='' border='0' /> <a href='#' onclick=\"ips_personal_portal.save_settings( 'gender', { 'pp_gender' : 'female' }, ''); return false;\">{$this->ipsclass->lang['m_gender_as_female']}</a></div>
						<div class='popupmenu-item-last'><img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/gender_mystery.png' alt='' border='0' /> <a href='#' onclick=\"ips_personal_portal.save_settings( 'gender', { 'pp_gender' : 'mystery' }, ''); return false;\">{$this->ipsclass->lang['m_gender_as_none']}</a></div>
					</div>
				") : ("")) . "
			</div>
			<div class='row1' style='padding:6px; padding-left:10px'>
				<div id='pp-entry-location-wrap'>
					" . (($member['location']) ? ("
						<span id='pp-entry-location-text'>{$member['location']}</span>
					") : ("
						<span id='pp-entry-location-text'>{$this->ipsclass->lang['m_location_unknown']}</span>
					")) . "
				</div>
				" . (($member['id'] == $this->ipsclass->member['id'] AND $this->ipsclass->member['g_edit_profile']==1) ? ("
					<div class='popupmenu-new' id='pp-entry-location-wrap_menu' style='display:none;width:auto'>
						<div class='popupmenu-item-last'>
							<fieldset>
								<legend>{$this->ipsclass->lang['m_enter_location']}</legend>
								<input type='text' size='20' maxlength='200' name='location' id='pp-location' value='{$member['location']}' /> <input class='button' type='button' value='{$this->ipsclass->lang['m_save_button']}' onclick=\"ips_personal_portal.save_settings( 'location', {}, 'pp-location'); return false;\" />
							</fieldset>
						</div>
					</div>
				") : ("")) . "
			</div>
			<div class='row1' style='padding:6px; margin-bottom:0px; padding-left:10px'>
				<div id='pp-entry-born-wrap'>
					" . (($member['bday_day'] AND $member['bday_year'] AND $member['_bday_month']) ? ("
						{$this->ipsclass->lang['born_key']} <span id='pp-entry-born-text'>{$member['_bday_month']}-{$member['bday_day']}-{$member['bday_year']}</span>
					") : ("
						<span id='pp-entry-born-text'>{$this->ipsclass->lang['m_bday_unknown']}</span>
					")) . "
				</div>
				" . (($member['id'] == $this->ipsclass->member['id'] AND $this->ipsclass->member['g_edit_profile']==1) ? ("
					<div class='popupmenu-new' id='pp-entry-born-wrap_menu' style='display:none;width:auto'>
						<div class='popupmenu-item-last'>
							<fieldset>
								<legend>{$this->ipsclass->lang['m_enter_bdate']}</legend>
								<select name='_b_month' id='pp_b_month'>{$member['_birthday_month']}</select>								
								<select name='_b_day' id='pp_b_day'>{$member['_birthday_day']}</select>
								<select name='_b_year' id='pp_b_year'>{$member['_birthday_year']}</select>
								<input class='button' type='button' value='{$this->ipsclass->lang['m_save_button']}' onclick=\"ips_personal_portal.save_settings( 'birthdate', {}, ''); return false;\" />
							</fieldset>
						</div>
					</div>
				") : ("")) . "
			</div>
			<!-- WARN -->
			" . (($member['_warn_data']) ? ("
				<div class='row1' style='padding:6px; margin-bottom:0px; padding-left:10px'>
					{$member['_warn_data']}
				</div>
			") : ("")) . "
			<!-- / WARN -->
			<!-- / Personal Info -->
			
			<!-- Interests -->
			" . (($member['_interests']) ? ("
				<div class='subtitle'>{$this->ipsclass->lang['interests']}</div>
				<div class='row1' style='padding:6px; padding-left:10px' id='pp-personal_statement'>
					{$member['_interests']}
				</div>
			") : ("")) . "
			<!-- / Interests -->
				
			<!-- Custom Fields -->
			" . ((is_array( $member['custom_fields'] ) AND count( $member['custom_fields'] )) ? ("
				<div class='subtitle'>{$this->ipsclass->lang['m_other_info']}</div>
				".$this->__foreach_loop__id_491a6170e4015($tabs,$member,$comments,$friends,$visitors,$default_tab)."
			") : ("")) . "
			<!-- / Custom Fields -->
			
			<!-- Statistics --> 
			<div class='subtitle'>{$this->ipsclass->lang['m_stats_title']}</div>
			<div class='row1' style='padding:6px; padding-left:10px'>{$this->ipsclass->lang['m_member_since']} {$member['_joined']}</div>
			<div class='row1' style='padding:6px; padding-left:10px'>{$this->ipsclass->lang['m_profile_views']} {$member['_pp_profile_views']}<span class='pp-tiny-text'>*</span></div>
			<div class='row1' style='padding:6px; padding-left:10px'>
				{$this->ipsclass->lang['m_last_seen']} {$member['_last_active']}
				" . (($member['_online_location']) ? ("
					<br />{$member['_online_location']}
				") : ("")) . "
			</div>
			
			" . (($member['_local_time']) ? ("
				<div class='row2' style='padding:6px; padding-left:10px'>{$this->ipsclass->lang['m_local_time_is']} {$member['_local_time']}</div>
			") : ("")) . "
			<div class='row1' style='padding:6px; padding-left:10px'>{$member['_posts']} {$this->ipsclass->lang['m_bit_posts']} ({$member['_posts_day']} {$this->ipsclass->lang['posts_per_day']})</div>
			<!-- / Statistics -->
			
			<!-- Contact Information -->
			<div class='subtitle'>{$this->ipsclass->lang['m_contact_info']}</div>
			<div class='row1' style='padding:6px; padding-left:10px'>
				<div id='pp-entry-contact-wrap-aim'>
					<{PRO_AIM}> <span id='pp-entry-contact-entry-aim'>{$member['_aim_name']}</span>
				</div>
			</div>
			" . (($member['id'] == $this->ipsclass->member['id'] AND $this->ipsclass->member['g_edit_profile']==1) ? ("
				<div class='popupmenu-new' id='pp-entry-contact-wrap-aim_menu' style='display:none;width:auto'>
					<div class='popupmenu-item-last'>
						<fieldset>
							<legend>{$this->ipsclass->lang['m_enter_aim']}</legend>
							<input type='text' size='20' maxlength='200' name='value' id='pp-contact-value-aim' value='{$member['aim_name']}' /> <input class='button' type='button' value='{$this->ipsclass->lang['m_save_button']}' onclick=\"ips_personal_portal.save_settings( 'contact', { 'contacttype' : 'aim' }, 'pp-contact-value-aim'); return false;\" />
						</fieldset>
					</div>
				</div>
			") : ("")) . "
			
			<div class='row1' style='padding:6px; padding-left:10px'>
				<div id='pp-entry-contact-wrap-yahoo'>
					<{PRO_YIM}> <span id='pp-entry-contact-entry-yahoo'>{$member['_yahoo']}</span>
				</div>
			</div>
			" . (($member['id'] == $this->ipsclass->member['id'] AND $this->ipsclass->member['g_edit_profile']==1) ? ("
				<div class='popupmenu-new' id='pp-entry-contact-wrap-yahoo_menu' style='display:none;width:auto'>
					<div class='popupmenu-item-last'>
						<fieldset>
							<legend>{$this->ipsclass->lang['m_enter_yahoo']}</legend>
							<input type='text' size='20' maxlength='200' name='value' id='pp-contact-value-yahoo' value='{$member['yahoo']}' /> <input type='button' class='button' value='{$this->ipsclass->lang['m_save_button']}' onclick=\"ips_personal_portal.save_settings( 'contact', { 'contacttype' : 'yahoo' }, 'pp-contact-value-yahoo'); return false;\" />
						</fieldset>
					</div>
				</div>
			") : ("")) . "
			
			<div class='row1' style='padding:6px; padding-left:10px'>
				<div id='pp-entry-contact-wrap-icq'>
					<{PRO_ICQ}> <span id='pp-entry-contact-entry-icq'>{$member['_icq_number']}</span>
				</div>
			</div>
			" . (($member['id'] == $this->ipsclass->member['id'] AND $this->ipsclass->member['g_edit_profile']==1) ? ("
				<div class='popupmenu-new' id='pp-entry-contact-wrap-icq_menu' style='display:none;width:auto'>
					<div class='popupmenu-item-last'>
						<fieldset>
							<legend>{$this->ipsclass->lang['m_enter_icq']}</legend>
							<input type='text' size='20' maxlength='200' name='value' id='pp-contact-value-icq' value='{$member['icq_number']}' /> <input type='button' class='button' value='{$this->ipsclass->lang['m_save_button']}' onclick=\"ips_personal_portal.save_settings( 'contact', { 'contacttype' : 'icq' }, 'pp-contact-value-icq'); return false;\" />
						</fieldset>
					</div>
				</div>
			") : ("")) . "
			
			<div class='row1' style='padding:6px; padding-left:10px'>
				<div id='pp-entry-contact-wrap-msn'>
					<{PRO_MSN}> <span id='pp-entry-contact-entry-msn'>{$member['_msn_name']}</span>
				</div>
			</div>
			" . (($member['id'] == $this->ipsclass->member['id'] AND $this->ipsclass->member['g_edit_profile']==1) ? ("
				<div class='popupmenu-new' id='pp-entry-contact-wrap-msn_menu' style='display:none;width:auto'>
					<div class='popupmenu-item-last'>
						<fieldset>
							<legend>{$this->ipsclass->lang['m_enter_msn']}</legend>
							<input type='text' size='20' maxlength='200' name='value' id='pp-contact-value-msn' value='{$member['msnname']}' /> <input type='button' class='button' value='{$this->ipsclass->lang['m_save_button']}' onclick=\"ips_personal_portal.save_settings( 'contact', { 'contacttype' : 'msn' }, 'pp-contact-value-msn'); return false;\" />
						</fieldset>
					</div>
				</div>
			") : ("")) . "
			
			<div class='row1' style='padding:6px; padding-left:10px'>
				<{PRO_CONTACT}> <a href=\"{$this->ipsclass->base_url}act=Msg&amp;CODE=4&amp;MID={$member['id']}\">{$this->ipsclass->lang['pm']}</a>
			</div>
			<div class='row1' style='padding:6px; padding-left:10px'>
				<{PRO_CONTACT}> {$member['_email']}
			</div>
			<!-- / Contact Information -->
		</div>
		<div class='pp-tiny-text'>{$this->ipsclass->lang['m_profile_views_desc']}</div>
		
		<!-- sssh.. ugly hack to stop IE collapsing this column under short widths -->
		<img src='{$this->ipsclass->vars['img_url']}/blank.gif' width='210' height='1' alt='' />
		
	<!-- / LEFT TABLE -->
	</td>
	<td valign='top'>
	<!-- MAIN TABLE -->
		<div class='pp-name'>
			<table cellpadding='0' cellspacing='0' width='100%'>
			<tr>
				<td width='1%'>{$member['_avatar']}</td>
				<td width='98%' style='padding-left:10px'>
					<h3 style='font-size:20px'>{$member['members_display_name']}</h3>
					<strong>{$member['g_title']}</strong>
					<p>{$member['_member_rank_img']}</p>
				</td>
			</tr>
			</table>
		</div>
		
		<br />
		
		<!-- My Stuff -->
		<div class='pp-tabwrap'>
			".$this->__foreach_loop__id_491a6170e43fc($tabs,$member,$comments,$friends,$visitors,$default_tab)."
				<div class='pp-taboff' id='pp-content-tab-comments'>{$this->ipsclass->lang['m_tab_comments']}</div>
				<div class='pp-taboff' id='pp-content-tab-friends'>{$this->ipsclass->lang['m_tab_friends']}</div>
				" . (($member['id'] == $this->ipsclass->member['id'] OR ( $this->ipsclass->member['g_is_supmod']==1 AND $member['mgroup'] != $this->ipsclass->vars['admin_group'] )) ? ("
					<div class='pp-taboff' id='pp-content-tab-settings'>{$this->ipsclass->lang['m_tab_settings']}</div>
				") : ("")) . "
		</div>
		<div class=\"pp-tabclear\">{$this->ipsclass->lang['m_title_content']}</div>
			<div id='pp-main-tab-content' class='pp-contentbox-back'>
				&nbsp;
			</div>
		<!-- / My Stuff -->
		
	<!-- / MAIN TABLE -->
	</td>
	<td style='width:210px;' valign='top'>
	<!-- RIGHT TABLE -->
	<!-- Recent Visitors -->
	<div class=\"borderwrap\">
		<div class=\"maintitle\">{$this->ipsclass->lang['m_title_visitors']}</div>
		" . ((is_array($visitors) and count($visitors)) ? ("
			".$this->__foreach_loop__id_491a6170e47e5($tabs,$member,$comments,$friends,$visitors,$default_tab)."
		") : ("
			<div class='post1' style='padding:6px'>
				<em>{$member['members_display_name']} {$this->ipsclass->lang['m_visitors_none']}.</em>
			</div>
		")) . "
		
	</div>
	<!-- / Recent Visitors -->
	
	<br />
	
	<!-- Comments -->
	<div class=\"borderwrap\">
		<div class=\"maintitle\">{$this->ipsclass->lang['m_title_comments']}</div>
			<div id='pp-comments-wrap'>
				$comments
			</div>
		" . (($this->ipsclass->member['id']) ? ("
			<div class='popmenubutton-new' id='pp-comment-wrap' style='margin:2px'>
				<img src='{$this->ipsclass->vars['img_url']}/folder_profile_portal/comment_add.png' alt='' border='0' /> {$this->ipsclass->lang['m_add_comment']}
			</div>
			<div class='popupmenu-new' id='pp-comment-wrap_menu' style='display:none;width:auto;'>
				<div class='popupmenu-item-last'>
					<fieldset>
						<legend>{$this->ipsclass->lang['m_enter_comment']}</legend>
						<textarea rows='8' cols='17' name='comment' id='pp-comment-textarea'></textarea>
						<div class='pp-tiny-text' style='text-align:right'>
							{$this->ipsclass->lang['m_max_chars']}
							<input type='button' class='button' value='{$this->ipsclass->lang['m_save_button']}' onclick=\"ips_personal_portal.save_comment(); return false;\" />
						</div>
					</fieldset>
				</div>
			</div>
			<script type='text/javascript'>
			//<![CDATA[
				ipsmenu.register( \"pp-comment-wrap\" );
			//]]>
			</script>
		") : ("")) . "
		
	</div>
	<!-- / Comments -->
	
	<br />
	
	<!-- Friends -->
	<div class=\"borderwrap\">
		<div class=\"maintitle\">{$this->ipsclass->lang['m_title_friends']}</div>
		" . ((is_array($friends) and count($friends)) ? ("
			".$this->__foreach_loop__id_491a6170e4bce($tabs,$member,$comments,$friends,$visitors,$default_tab)."
			<div class='pp-mini-content-entry-noheight' style='text-align:right'>
				<a href='#' onclick=\"ips_personal_portal.tab_load( 'friends' )\">{$this->ipsclass->lang['m_view_friends']}</a>
			</div>
		") : ("
			<div class='post1' style='padding:6px'>
				<em>{$this->ipsclass->lang['m_no_friends']}.</em>
			</div>
		")) . "
	</div>
	<!-- / Friends -->
	
	<!-- sssh.. ugly hack to stop IE collapsing this column under short widths -->
	<img src='{$this->ipsclass->vars['img_url']}/blank.gif' width='210' height='1' alt='' />
	
	<!-- / RIGHT TABLE -->
	</td>
</tr>
</table>
<script type='text/javascript'>
//<![CDATA[
// Settings
ips_personal_portal.settings['allow_rating']      = parseInt(\"{$this->ipsclass->vars['pp_allow_member_rate']}\");
ips_personal_portal.settings['default_rating']    = parseInt(\"{$member['_pp_rating_real']}\");
ips_personal_portal.settings['member_id']         = parseInt(\"{$member['id']}\");
ips_personal_portal.settings['is_super_mod']      = parseInt(\"{$member['g_is_supmod']}\");
ips_personal_portal.settings['viewer_id']         = parseInt(\"{$this->ipsclass->member['id']}\");
ips_personal_portal.settings['edit_allowed']	  = parseInt(\"{$this->ipsclass->member['g_edit_profile']}\");
ips_personal_portal.settings['img_base_url']      = ipb_var_image_url + '/folder_profile_portal';
ips_personal_portal.settings['img_menu_icon']     = \"{$this->ipsclass->vars['img_url']}/menu_action_down.gif\";
ips_personal_portal.settings['img_friend_remove'] = \"{$this->ipsclass->vars['img_url']}/folder_profile_portal/friend_remove_small.png\";
ips_personal_portal.settings['img_friend_add']    = \"{$this->ipsclass->vars['img_url']}/folder_profile_portal/friend_add_small.png\";
ips_personal_portal.settings['default_tab']       = '{$default_tab}';

// Languages
ips_personal_portal.languages['rate_me']          = '<span class=\"desc\">{$this->ipsclass->lang['m_rate_me']}</span>';
ips_personal_portal.languages['friend_add']       = '{$this->ipsclass->lang['m_friend_add']}';
ips_personal_portal.languages['friend_remove']    = '{$this->ipsclass->lang['m_friend_remove']}';
ips_personal_portal.languages['img_alt_rate']     = '{$this->ipsclass->lang['js_img_alt_rate_p']}';
ips_personal_portal.languages['gender_male']      = '{$this->ipsclass->lang['js_gender_male']}';
ips_personal_portal.languages['gender_female']    = '{$this->ipsclass->lang['js_gender_female']}';
ips_personal_portal.languages['gender_mystery']   = '{$this->ipsclass->lang['js_gender_mystery']}';
ips_personal_portal.languages['loading_tab']      = '{$this->ipsclass->lang['js_loading_tab']}';
ips_personal_portal.languages['deleting_comment'] = '{$this->ipsclass->lang['js_deleting_comment']}';
ips_personal_portal.languages['saving_comment']   = '{$this->ipsclass->lang['js_saving_comment']}';

// INIT
ips_personal_portal.init();

// Load tab
ips_personal_portal.load_content_tab( '{$default_tab}' );
	
menu_build_menu(
\"profile-options\", new Array(
							" . (($this->ipsclass->member['id'] != 0 AND $this->ipsclass->member['id'] != $member['id']) ? ("
							'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=usercp&amp;CODE=ignore&amp;uid={$member['id']}'>{$this->ipsclass->lang['ignore_user']}</a>\",
							") : ("")) . "
							" . (($this->ipsclass->member['g_is_supmod'] == 1) ? ("
							'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=mod&amp;CODE=editmember&amp;auth_key={$this->ipsclass->md5_check}&amp;member={$member['id']}'>{$this->ipsclass->lang['supmod_edit_member']}</a>\",
							") : ("")) . "
							" . (($this->ipsclass->vars['auth_allow_dnames'] == 1) ? ("
							'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='#' onclick='return profile_dname_history({$member['id']})'>{$this->ipsclass->lang['dname_title']}</a>\",
							") : ("")) . "
							" . (($this->ipsclass->member['id'] != 0 AND $this->ipsclass->member['id'] != $member['id']) ? ("
							'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=Msg&amp;CODE=02&amp;MID={$member['id']}'>{$this->ipsclass->lang['op_add_pm_to_block']}</a>\",
							") : ("")) . "
 							'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=Search&amp;CODE=getalluser&amp;mid={$member['id']}'>{$this->ipsclass->lang['find_posts']}</a>\",
				 			'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=Search&amp;CODE=gettopicsuser&amp;mid={$member['id']}'>{$this->ipsclass->lang['find_member_topics']}</a>\"
) );


//]]>
</script>
" . ((in_array( $member['id'], array_keys( $this->ipsclass->member['_cache']['friends'] ) )) ? ("
	<script type='text/javascript'>
	//<![CDATA[
		ips_personal_portal.show_friend_add_or_remove( 0 );
	//]]>
	</script>
") : ("
	<script type='text/javascript'>
	//<![CDATA[
		ips_personal_portal.show_friend_add_or_remove( 1 );
	//]]>
	</script>")) . "";
//--endhtml--//
return $IPBHTML;
}


//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e4015($tabs=array(),$member=array(),$comments="",$friends=array(),$visitors=array(),$default_tab='posts')
{
	$_ips___x_retval = '';
	
	foreach( $member['custom_fields'] as $data )
	{
		
		$_ips___x_retval .= "
					<div class='row1' style='padding:6px; padding-left:10px'>{$data['name']}: {$data['data']}</div>
				";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e43fc($tabs=array(),$member=array(),$comments="",$friends=array(),$visitors=array(),$default_tab='posts')
{
	$_ips___x_retval = '';
	
	foreach( $tabs as $tab )
	{
		
		$_ips___x_retval .= "
				<div class='pp-taboff' id='pp-content-tab-{$tab['plugin_key']}'>{$tab['_lang']}</div>
			";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e47e5($tabs=array(),$member=array(),$comments="",$friends=array(),$visitors=array(),$default_tab='posts')
{
	$_ips___x_retval = '';
	
	foreach( $visitors as $visitor )
	{
		
		$_ips___x_retval .= "
				<div class='pp-mini-content-entry'>
					<div class='pp-image-thumb-wrap-floatright'><img src='{$visitor['pp_thumb_photo']}' width='{$visitor['pp_thumb_width']}' height='{$visitor['pp_thumb_height']}' alt='' /></div>
					<div style='position:absolute;z-index:2;'>
						{$visitor['_pp_gender_image']} <strong>" . (($visitor['id']) ? ("<a href='{$this->ipsclass->base_url}showuser={$visitor['id']}'>") : ("")) . "{$visitor['members_display_name_short']}" . (($visitor['id']) ? ("</a>") : ("")) . "</strong>
					</div>
					<br />
					<br />
					<div class='pp-tiny-text'>{$visitor['_pp_online_image']} {$visitor['_visited_date']}</div>
				</div>
			";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e4bce($tabs=array(),$member=array(),$comments="",$friends=array(),$visitors=array(),$default_tab='posts')
{
	$_ips___x_retval = '';
	
	foreach( $friends as $friend )
	{
		
		$_ips___x_retval .= "
				<div class='pp-mini-content-entry'>
					<div class='pp-image-thumb-wrap-floatright'><img src='{$friend['pp_thumb_photo']}' width='{$friend['pp_thumb_width']}' height='{$friend['pp_thumb_height']}' alt='' /></div>
					<div style='position:absolute;z-index:2;'>
						{$friend['_pp_gender_image']} <strong><a href='{$this->ipsclass->base_url}showuser={$friend['id']}'>{$friend['members_display_name_short']}</a></strong>
					</div>
					<br />
							<div class='pp-tiny-text'>
								{$friend['posts']} {$this->ipsclass->lang['m_bit_posts']}
								<br />{$friend['_pp_online_image']} {$friend['_last_active']}
							</div>
				</div>
			";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// <ips:personal_portal_no_content:desc::trigger:>
//===========================================================================
function personal_portal_no_content($langkey="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<table cellspacing=\"1\" width=\"100%\"><tr>
	<td class=\"row1\" align=\"center\">
		<b>{$this->ipsclass->lang[ $langkey ]}</b>
	</td>
</tr></table>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:personal_portal_show_comment:desc::trigger:>
//===========================================================================
function personal_portal_show_comment($comments="",$member=array(),$new_id=0,$return_msg='') {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "" . ((is_array($comments) and count($comments)) ? ("
	".$this->__foreach_loop__id_491a6170e5785($comments,$member,$new_id,$return_msg)."
") : ("
	<div class='post1' style='padding:6px'>
		<em>{$this->ipsclass->lang['m_no_comments']} {$member['members_display_name']}.</em>
	</div>
")) . "
" . (($return_msg) ? ("
	<script type=\"text/javascript\">
	//<![CDATA[
		show_inline_messages_instant( \"$return_msg\" );
	//]]>
	</script>
") : ("")) . "
" . (($new_id) ? ("
	<script type='text/javascript'>
	//<![CDATA[
		ipsclass.fade_in_element( 'pp-comment-entry-{$new_id}' );
	//]]>
	</script>
") : ("")) . "";
//--endhtml--//
return $IPBHTML;
}


//===========================================================================
// Foreach loop function
//===========================================================================

function __foreach_loop__id_491a6170e5785($comments="",$member=array(),$new_id=0,$return_msg='')
{
	$_ips___x_retval = '';
	
	foreach( $comments as $comment )
	{
		
		$_ips___x_retval .= "
		<div class='pp-mini-content-entry-noheight' id='pp-comment-entry-{$comment['comment_id']}'>
			<div class='pp-tiny-text'>
			<div class='pp-image-mini-wrap-floatright'><img src='{$comment['pp_mini_photo']}' width='{$comment['pp_mini_width']}' height='{$comment['pp_mini_height']}' alt='' /></div>
				{$comment['_pp_gender_image']} <strong><a href='{$this->ipsclass->base_url}showuser={$comment['id']}'>{$comment['members_display_name_short']}</a></strong>
				<br />
				{$comment['comment_content']}
				<br />
				" . (($this->ipsclass->member['id'] == $member['id'] OR $this->ipsclass->member['g_is_supmod']) ? ("
					<a href='#' onclick='ips_personal_portal.delete_comment(\"{$comment['comment_id']}\"); return false'><img src=\"{$this->ipsclass->vars['img_url']}/folder_profile_portal/comment_remove.gif\" style='vertical-align:bottom;' id=\"pp-comment-delete-{$comment['comment_id']}\" title='{$this->ipsclass->lang['m_delete_comment']}' border=\"0\" /></a>
				") : ("")) . "
				<strong>{$comment['_comment_date']}</strong>
			</div>
		</div>
	";
	}
	
	return $_ips___x_retval;
}

//===========================================================================
// <ips:personal_portal_single_column:desc::trigger:>
//===========================================================================
function personal_portal_single_column($row=array(),$read_more_link='',$url='',$title='') {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<div>
	<div class='pp-contentbox-entry'>
		<div class='pp-datebox'>
			{$row['_date_array']['mday']} {$row['_date_array']['smonth']} <em>{$row['_date_array']['year']}</em>
			" . (($read_more_link AND $url) ? ("
				<div style='font-size:10px; font-weight:normal'><a href='$url'>{$read_more_link}</a></div>
			") : ("")) . "
		</div>
		" . (($title) ? ("
			" . (($url) ? ("
				<div style='font-weight:bold;font-size:16px;border-bottom:1px solid #CCC; padding-bottom:5px;'>
					<a href=\"$url\" style='text-decoration:none'>$title</a>
				</div>
			") : ("
				<div style='font-weight:bold;font-size:16px;border-bottom:1px solid #CCC; padding-bottom:5px;'>$title</div>
			")) . "
		") : ("")) . "
		<div style='margin:5px'>{$row['post']}</div>
	</div>
</div>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:show_card:desc::trigger:>
//===========================================================================
function show_card($name="",$photo="",$info="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<script language=\"javascript\" type=\"text/javascript\">
<!--
 function redirect_to(where, closewin)
 {
 	opener.location= '{$this->ipsclass->base_url}' + where;
 	
 	if (closewin == 1)
 	{
 		self.close();
 	}
 }
//-->
</script>
<div class=\"borderwrap\" style=\"text-align: left;\">
	<div class=\"maintitle\">$name</div>
	<table cellspacing=\"1\" width='100%' class='row1'>
		<tr>
			<th><b>{$this->ipsclass->lang['head_contact']}</b></th>
			<th><b>{$this->ipsclass->lang['photo_title']}</b></th>
		</tr>
		<tr>
			<td valign=\"middle\" class=\"nopad\">
				<table class='ipbtable' cellspacing=\"1\">
" . (($this->ipsclass->vars['blog_default_view'] != "" and $info['has_blog'] == 1) ? ("
<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['myblog']}</td>
						<td width=\"100%\" class=\"row1\"><b><a href='javascript:redirect_to(\"&amp;automodule=blog&amp;req=showblog&amp;mid={$info['mid']}\",1);'>{$this->ipsclass->lang['click_here']}</a></b></td>
					</tr>
") : ("")) . "
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['email']}</td>
						<td width=\"100%\" class=\"row1\"><b>{$info['email']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['website_addr']}</td>
						<td width=\"100%\" class=\"row1\"><b>{$info['website']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['aim']}</td>
						<td width=\"100%\" class=\"row1\"><{PRO_AIM}> <b>{$info['aim_name']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['icq']}</td>
						<td width=\"100%\" class=\"row1\"><{PRO_ICQ}> <b>{$info['icq_number']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['yahoo']}</td>
							<td width=\"100%\" class=\"row1\"><{PRO_YIM}> <b>{$info['yahoo']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['msn']}</td>
						<td width=\"100%\" class=\"row1\"><{PRO_MSN}> <b>{$info['msn_name']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['pm']}</b></td>
						<td class=\"row1\"><b><a href=\"javascript:redirect_to('&amp;act=Msg&amp;CODE=4&amp;MID={$info['mid']}', 1);\">{$this->ipsclass->lang['click_here']}</a></b></td>
					</tr>
				</table>
			</td>
			<td valign=\"middle\" class=\"row1\" align=\"center\">$photo</td>
		</tr>
		<tr>
			<td class=\"formbuttonrow\" colspan=\"2\"><a href=\"{$this->ipsclass->base_url}act=Profile&amp;CODE=showcard&amp;MID={$info['mid']}&amp;download=1\">{$this->ipsclass->lang['ac_download']}</a> &middot; <a href=\"javascript:self.close();\">{$this->ipsclass->lang['ac_close']}</a></td>
		</tr>
		<tr>
			<td class=\"catend\" colspan=\"2\"><!-- no content --></td>
		</tr>
	</table>
</div>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:show_card_download:desc::trigger:>
//===========================================================================
function show_card_download($name="",$photo="",$info="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<html>
	<head>
		<title>$name</title>
		<style type=\"text/css\">
			<!--CSS-->
		</style>
		<script language=\"javascript\" type=\"text/javascript\">
		<!--
		function redirect_to(where, closewin)
		{
		  document.location= \"{$this->ipsclass->base_url}\" + where;
		  
		  if (closewin == 1)
		  {
			  self.close();
		  }
		}
		//-->
		</script>
	</head>
	<body>
	<div class=\"borderwrap\" style=\"text-align: left;\">
	<div class=\"maintitle\">$name</div>
	<table cellspacing=\"1\" class='row1'>
		<tr>
			<th><b>{$this->ipsclass->lang['head_contact']}</b></th>
			<th><b>{$this->ipsclass->lang['photo_title']}</b></th>
		</tr>
		<tr>
			<td valign=\"middle\" class=\"nopad\">
				<table class='ipbtable' cellspacing=\"1\">
" . (($this->ipsclass->vars['blog_default_view'] != "" and $info['has_blog'] == 1) ? ("
<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['myblog']}</td>
						<td width=\"100%\" class=\"row1\"><b><a href='javascript:redirect_to(\"&amp;automodule=blog&amp;req=showblog&amp;mid={$info['mid']}\",1);'>{$this->ipsclass->lang['click_here']}</a></b></td>
					</tr>
") : ("")) . "
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['email']}</td>
						<td width=\"100%\" class=\"row1\"><b>{$info['email']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['website_addr']}</td>
						<td width=\"100%\" class=\"row1\"><b>{$info['website']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['aim']}</td>
						<td width=\"100%\" class=\"row1\"><{PRO_AIM}> <b>{$info['aim_name']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['icq']}</td>
						<td width=\"100%\" class=\"row1\"><{PRO_ICQ}> <b>{$info['icq_number']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['yahoo']}</td>
							<td width=\"100%\" class=\"row1\"><{PRO_YIM}> <b>{$info['yahoo']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['msn']}</td>
						<td width=\"100%\" class=\"row1\"><{PRO_MSN}> <b>{$info['msn_name']}</b></td>
					</tr>
					<tr>
						<td nowrap=\"nowrap\" class=\"row1\">{$this->ipsclass->lang['pm']}</b></td>
						<td class=\"row1\"><b><a href=\"javascript:redirect_to('&amp;act=Msg&amp;CODE=4&amp;MID={$info['mid']}', 1);\">{$this->ipsclass->lang['click_here']}</a></b></td>
					</tr>
				</table>
			</td>
			<td valign=\"middle\" class=\"row1\" align=\"center\">$photo</td>
		</tr>
		<tr>
			<td class=\"catend\" colspan=\"2\"><!-- no content --></td>
		</tr>
	</table>
   </div>
	</body>
</html>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:show_photo:desc::trigger:>
//===========================================================================
function show_photo($name="",$photo="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<div id=\"photowrap\">
	<div id=\"phototitle\">$name</div>
	<div id=\"photoimg\">$photo</div>
</div>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:show_profile:desc::trigger:>
//===========================================================================
function show_profile($info="",$auth_key="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<script type=\"text/javascript\" src=\"jscripts/ipb_profile.js\"></script>
<script type='text/javascript' src=\"{$this->ipsclass->vars['board_url']}/jscripts/ips_profile_portal.js\"></script>
<div class=\"borderwrap\">
<div class=\"maintitle\" style='padding:4px'>
    <table width='100%' cellspacing='0' cellpadding='0'>
     <tr>
      <td width='99%'><div><{CAT_IMG}>&nbsp;{$this->ipsclass->lang['head_title']}: {$info['members_display_name']}</div></td>
      <td width='1%' nowrap='nowrap' align='right'>
      <div class='popmenubutton' id='profile-options'><a href='#profileoptions'>{$this->ipsclass->lang['profile_options']}</a> <img src='{$this->ipsclass->vars['img_url']}/menu_action_down.gif' alt='V' title='{$this->ipsclass->lang['open_menu']}' border='0' /></div>
      </td>
     </tr>
    </table>
</div>
	<table class='ipbtable' cellspacing=\"1\">
		<tr>
			<td width=\"1%\" nowrap=\"nowrap\" valign=\"top\" class=\"row1\">
				<div id=\"profilename\">{$info['members_display_name']}</div>
				<br />
				<div>{$info['avatar']}</div>
				<div>{$info['member_title']}</div>
				<div>{$info['member_rank_img']}</div>
				<br />
				<div class=\"postdetails\">
					{$this->ipsclass->lang['mgroup']}: {$info['group_title']}<br />
					{$this->ipsclass->lang['joined']}: {$info['joined']}
				</div>
				" . (($this->ipsclass->member['id'] AND ( $info['mid'] != $this->ipsclass->member['id'])) ? ("
					<div id='pp-friend-wrap'>
						<!-- Add / remove friend added via JS -->
					</div>
				") : ("")) . "
				<!--{WARN_LEVEL}-->
			</td>
			<td width=\"1%\" align=\"right\" class=\"row1\">{$info['photo']}</td>
		</tr>
	</table>
</div>
<br />
<table class='ipbtable' cellspacing=\"1\">
	<tr>
		<!-- STATS -->
		<td width=\"50%\" valign=\"top\" style=\"padding-left: 0;\">
			<table cellspacing=\"1\" width='100%' class=\"borderwrap\">
				<tr>
					<td align=\"center\" colspan=\"2\" class=\"maintitle\">{$this->ipsclass->lang['active_stats']}</td>
				</tr>
				<tr>
					<td class=\"row2\" valign=\"top\"><b>{$this->ipsclass->lang['user_local_time']}</b></td>
					<td class=\"row1\">{$info['local_time']}</td>
				</tr>
				<tr>
					<td class=\"row2\" width=\"30%\" valign=\"top\"><b>{$this->ipsclass->lang['total_posts']}</b></td>
					<td width=\"70%\" class=\"row1\"><b>{$info['posts']}</b>
					<br />( {$info['posts_day']} {$this->ipsclass->lang['posts_per_day']} / {$info['total_pct']}% {$this->ipsclass->lang['total_percent']} )
					</td>
				</tr>
				<tr>
					<td class=\"row2\" valign=\"top\"><b>{$this->ipsclass->lang['fav_forum']}</b></td>
					<td class=\"row1\">
" . (($info['fav_id']) ? ("
<a href=\"{$info['base_url']}act=SF&amp;f={$info['fav_id']}\">
") : ("")) . "
<b>{$info['fav_forum']}</b>
" . (($info['fav_id']) ? ("
</a>
") : ("")) . "
<br />( {$info['fav_posts']} {$this->ipsclass->lang['fav_posts']} / {$info['percent']}% {$this->ipsclass->lang['fav_percent']} )</td>
				</tr>
				<tr>
					<td class=\"row2\" valign=\"top\"><b>{$this->ipsclass->lang['last_active']}</b></td>
					<td class=\"row1\">{$info['last_active']}</td>
				</tr>
				<tr>
					<td class=\"row2\" valign=\"top\"><b>{$this->ipsclass->lang['last_click']}</b></td>
					<td class=\"row1\">{$info['online_status_indicator']} {$info['online_extra']}</td>
				</tr>
			</table>
		</td>
		<!-- Communication -->
		<td width=\"50%\" valign=\"top\" style=\"padding-right: 0;\">
			<table cellspacing=\"1\" width='100%' class=\"borderwrap\">
				<tr>
					<td align=\"center\" colspan=\"2\" class=\"maintitle\">{$this->ipsclass->lang['communicate']}</td>
				</tr>
				<tr>
					<td width=\"1%\" class=\"row1\"><{PRO_AIM}></td>
					<td width=\"99%\" class=\"row2\">{$info['aim_name']}</td>
				</tr>
				<tr>
					<td width=\"1%\" class=\"row1\"><{PRO_YIM}></td>
					<td width=\"99%\" class=\"row2\">{$info['yahoo']}</td>
				</tr>
				<tr>
					<td width=\"1%\" class=\"row1\"><{PRO_ICQ}></td>
					<td width=\"99%\" class=\"row2\">{$info['icq_number']}</td>
				</tr>
				<tr>
					<td width=\"1%\" class=\"row1\"><{PRO_MSN}></td>
					<td width=\"99%\" class=\"row2\">{$info['msn_name']}</td>
				</tr>
				<tr>
					<td width=\"1%\" class=\"row1\"><{PRO_CONTACT}></td>
					<td width=\"99%\" class=\"row2\"><a href=\"{$info['base_url']}act=Msg&amp;CODE=4&amp;MID={$info['mid']}\">{$this->ipsclass->lang['pm']}</a></td>
				</tr>
				<tr>
					<td width=\"1%\" class=\"row1\"><{PRO_CONTACT}></td>
					<td width=\"99%\" class=\"row2\">{$info['email']}</td>
				</tr>
			</table>
		</td>
		<!-- END CONTENT ROW 1 -->
		<!-- information -->
	</tr>
	<tr>
		<td width=\"50%\" valign=\"top\" style=\"padding-left: 0;\">
			<table cellspacing=\"1\" width='100%' class=\"borderwrap\">
				<tr>
					<td align=\"center\" colspan=\"2\" class=\"maintitle\">{$this->ipsclass->lang['info']}</td>
				</tr>
" . (($this->ipsclass->vars['blog_default_view'] != "" and $info['has_blog'] == 1) ? ("
<tr>
						<td class=\"row2\" width=\"30%\" valign=\"top\"><b>{$this->ipsclass->lang['myblog']}</b></td>
						<td width=\"70%\" class=\"row1\"><a href='{$this->ipsclass->base_url}automodule=blog&amp;req=showblog&amp;mid={$info['mid']}'>{$this->ipsclass->lang['click_here']}</a></td>
					</tr>
") : ("")) . "
" . (($info['has_gallery'] == 1) ? ("
<tr>
     <td class=\"row2\" width=\"30%\" valign=\"top\"><b>{$this->ipsclass->lang['mygallery']}</b></td>
     <td width=\"70%\" class=\"row1\"><a href=\"{$this->ipsclass->base_url}automodule=gallery&amp;req=user&amp;user={$info['mid']}\">{$this->ipsclass->lang['click_here']}</a></td>
</tr>
") : ("")) . "
				<tr>
					<td class=\"row2\" width=\"30%\" valign=\"top\"><b>{$this->ipsclass->lang['homepage']}</b></td>
					<td width=\"70%\" class=\"row1\">{$info['homepage']}</td>
				</tr>
				<tr>
					<td class=\"row2\" valign=\"top\"><b>{$this->ipsclass->lang['birthday']}</b></td>
					<td class=\"row1\">{$info['birthday']}</td>
				</tr>
				<tr>
					<td class=\"row2\" valign=\"top\"><b>{$this->ipsclass->lang['location']}</b></td>
					<td class=\"row1\">{$info['location']}</td>
				</tr>
				<tr>
					<td class=\"row2\" valign=\"top\"><b>{$this->ipsclass->lang['interests']}</b></td>
					<td class=\"row1\">{$info['interests']}</td>
				</tr>
			</table>
		</td>
		<!-- Profile -->
		<td width=\"50%\" valign=\"top\" style=\"padding-right: 0;\">
			<table cellspacing=\"1\" width='100%' class=\"borderwrap\">
				<tr>
					<td align=\"center\" colspan=\"2\" class=\"maintitle\">{$this->ipsclass->lang['head_addit']}</td>
				</tr>
				<!--{CUSTOM.FIELDS}-->
			</table>
		</td>
	</tr>
</table>
" . (($info['signature'] != "") ? ("
<br />
<div class=\"borderwrap\">
<table class='ipbtable' width='100%' cellspacing=\"1\">
	<tr>
		<td class=\"maintitle\">{$this->ipsclass->lang['siggie']}</td>
	</tr>
	<tr>
		<td class=\"row2\">
			<div class=\"signature\">{$info['signature']}</div>
		</td>
	</tr>
</table>
</div>
") : ("")) . "
<!--MEM OPTIONS-->
<script type=\"text/javascript\">
//<![CDATA[
  var dname_title = \"{$this->ipsclass->lang['dname_title']}\";
  menu_build_menu(
  \"profile-options\",
  new Array(
  			 '<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=Search&amp;CODE=getalluser&amp;mid={$info['mid']}'>{$this->ipsclass->lang['find_posts']}</a>\",
  			 '<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=Search&amp;CODE=gettopicsuser&amp;mid={$info['mid']}'>{$this->ipsclass->lang['find_member_topics']}</a>\",
" . (($this->ipsclass->member['id'] != 0) ? ("
'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=usercp&amp;CODE=ignore&amp;uid={$info['mid']}'>{$this->ipsclass->lang['ignore_user']}</a>\",
") : ("")) . "
" . (($this->ipsclass->member['g_is_supmod'] == 1) ? ("
'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=mod&amp;CODE=editmember&amp;auth_key={$auth_key}&amp;mid={$info['mid']}'>{$this->ipsclass->lang['supmod_edit_member']}</a>\",
") : ("")) . "
" . (($this->ipsclass->vars['auth_allow_dnames'] == 1) ? ("
'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='#' onclick='return profile_dname_history({$info['mid']})'>{$this->ipsclass->lang['dname_title']}</a>\",
") : ("")) . "
			'<img src=\"style_images/<#IMG_DIR#>/profile_item.gif\" border=\"0\" />' + \" <a href='{$this->ipsclass->base_url}act=Msg&amp;CODE=02&amp;MID={$info['mid']}'>{$this->ipsclass->lang['op_add_pm_to_block']}</a>\"
		) );
//]]>
ips_personal_portal.settings['allow_rating']      = parseInt(\"{$this->ipsclass->vars['pp_allow_member_rate']}\");
ips_personal_portal.settings['member_id']         = parseInt(\"{$info['mid']}\");
ips_personal_portal.settings['is_super_mod']      = parseInt(\"{$info['g_is_supmod']}\");
ips_personal_portal.settings['viewer_id']         = parseInt(\"{$this->ipsclass->member['id']}\");
ips_personal_portal.settings['edit_allowed']	  = parseInt(\"{$this->ipsclass->member['g_edit_profile']}\");
ips_personal_portal.settings['img_base_url']      = ipb_var_image_url + '/folder_profile_portal';
ips_personal_portal.settings['img_menu_icon']     = \"{$this->ipsclass->vars['img_url']}/menu_action_down.gif\";
ips_personal_portal.settings['img_friend_remove'] = \"{$this->ipsclass->vars['img_url']}/folder_profile_portal/friend_remove_small.png\";
ips_personal_portal.settings['img_friend_add']    = \"{$this->ipsclass->vars['img_url']}/folder_profile_portal/friend_add_small.png\";
// Languages
ips_personal_portal.languages['rate_me']          = '<span class=\"desc\">{$this->ipsclass->lang['m_rate_me']}</span>';
ips_personal_portal.languages['friend_add']       = '{$this->ipsclass->lang['m_friend_add']}';
ips_personal_portal.languages['friend_remove']    = '{$this->ipsclass->lang['m_friend_remove']}';
ips_personal_portal.languages['img_alt_rate']     = '{$this->ipsclass->lang['js_img_alt_rate']}';
ips_personal_portal.languages['gender_male']      = '{$this->ipsclass->lang['js_gender_male']}';
ips_personal_portal.languages['gender_female']    = '{$this->ipsclass->lang['js_gender_female']}';
ips_personal_portal.languages['gender_mystery']   = '{$this->ipsclass->lang['js_gender_mystery']}';
ips_personal_portal.languages['loading_tab']      = '{$this->ipsclass->lang['js_loading_tab']}';
ips_personal_portal.languages['deleting_comment'] = '{$this->ipsclass->lang['js_deleting_comment']}';
ips_personal_portal.languages['saving_comment']   = '{$this->ipsclass->lang['js_saving_comment']}';
// INIT
ips_personal_portal.init();
</script>
" . ((is_array( $this->ipsclass->member['_cache']['friends'] ) AND in_array( $info['mid'], array_keys( $this->ipsclass->member['_cache']['friends'] ) )) ? ("
	<script type='text/javascript'>
	//<![CDATA[
		ips_personal_portal.show_friend_add_or_remove( 0 );
	//]]>
	</script>
") : ("
	<script type='text/javascript'>
	//<![CDATA[
		ips_personal_portal.show_friend_add_or_remove( 1 );
	//]]>
	</script>
")) . "";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:user_edit:desc::trigger:>
//===========================================================================
function user_edit($info="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "<br />
<div class=\"borderwrap\">
	<div class=\"formsubtitle\" align=\"center\" style=\"padding: 5px;\">
		<a href=\"{$info['base_url']}act=UserCP&amp;CODE=22\">{$this->ipsclass->lang['edit_my_sig']}</a> &middot;
		<a href=\"{$info['base_url']}act=UserCP&amp;CODE=24\">{$this->ipsclass->lang['edit_avatar']}</a> &middot;
		<a href=\"{$info['base_url']}act=UserCP&amp;CODE=01\">{$this->ipsclass->lang['edit_profile']}</a>
	</div>
</div>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:warn_level:desc::trigger:>
//===========================================================================
function warn_level($mid="",$img="",$percent="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "{$this->ipsclass->lang['warn_title']} (<a href=\"javascript:PopUp('{$this->ipsclass->base_url}act=warn&amp;mid={$mid}&amp;CODE=view','Pager','500','450','0','1','1','1')\">{$percent}</a>%) <a href=\"{$this->ipsclass->base_url}act=warn&amp;type=minus&amp;mid={$mid}\" title=\"{$this->ipsclass->lang['tt_warn_minus']}\"><{WARN_MINUS}></a>{$img}<a href=\"{$this->ipsclass->base_url}act=warn&amp;type=add&amp;mid={$mid}\" title=\"{$this->ipsclass->lang['tt_warn_add']}\"><{WARN_ADD}></a>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:warn_level_no_mod:desc::trigger:>
//===========================================================================
function warn_level_no_mod($mid="",$img="",$percent="") {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "{$this->ipsclass->lang['warn_level']}: (<a href=\"javascript:PopUp('{$this->ipsclass->base_url}act=warn&amp;mid={$mid}&amp;CODE=view','Pager','500','450','0','1','1','1')\">{$percent}</a>%) {$img}";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:warn_level_rating:desc::trigger:>
//===========================================================================
function warn_level_rating($mid="",$level="",$min=0,$max=10) {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "{$this->ipsclass->lang['warn_level']}: <a href=\"{$this->ipsclass->base_url}act=warn&amp;type=minus&amp;mid={$mid}\" title=\"{$this->ipsclass->lang['tt_warn_minus']}\"><{WARN_MINUS}></a> &lt;&nbsp;$min ( <a href=\"javascript:PopUp('{$this->ipsclass->base_url}act=warn&amp;mid={$mid}&amp;CODE=view','Pager','500','450','0','1','1','1')\">{$level}</a> ) $max&nbsp;&gt; <a href=\"{$this->ipsclass->base_url}act=warn&amp;type=add&amp;mid={$mid}\" title=\"{$this->ipsclass->lang['tt_warn_add']}\"><{WARN_ADD}></a>";
//--endhtml--//
return $IPBHTML;
}

//===========================================================================
// <ips:warn_level_rating_no_mod:desc::trigger:>
//===========================================================================
function warn_level_rating_no_mod($mid="",$level="",$min=0,$max=10) {
$IPBHTML = "";
//--starthtml--//
$IPBHTML .= "&lt;&nbsp;$min ( <a href=\"javascript:PopUp('{$this->ipsclass->base_url}act=warn&amp;mid={$mid}&amp;CODE=view','Pager','500','450','0','1','1','1')\">{$level}</a> ) $max&nbsp;&gt;";
//--endhtml--//
return $IPBHTML;
}



}

/*--------------------------------------------------*/
/*<changed bits>
personal_portal_main
</changed bits>*/
/* END OF FILE                                      */
/*--------------------------------------------------*/

?>